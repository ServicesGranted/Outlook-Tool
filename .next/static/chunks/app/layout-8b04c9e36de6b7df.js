(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2212:(e,t,o)=>{Promise.resolve().then(o.bind(o,7291)),Promise.resolve().then(o.t.bind(o,9840,23)),Promise.resolve().then(o.t.bind(o,9324,23))},7291:(e,t,o)=>{"use strict";o.d(t,{AuthProvider:()=>d,A:()=>h});var a=o(5155),i=o(2115),n=o(2095),l=o(8544);o(9509);let r={auth:{clientId:"e6aa6227-d8e8-4fd4-90d0-761af7afb40d",authority:"https://login.microsoftonline.com/common",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{logLevel:l.$.Info}}},s={scopes:["openid","profile","offline_access","Mail.Send","Mail.ReadWrite","Calendars.ReadWrite"]},c=(0,i.createContext)(void 0),u=new n.vq(r),d=e=>{let{children:t}=e,[o,n]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(!u)return;u.initialize().catch(e=>console.warn("MSAL init warning:",e));let e=localStorage.getItem("msal_token");e&&n(e)},[]);let l=async()=>{if(u)try{await u.initialize();let e=await u.loginPopup(s);n(e.accessToken),localStorage.setItem("msal_token",e.accessToken)}catch(e){console.error("Login failed",e)}},r=async()=>{u&&(await u.logoutPopup(),n(null),localStorage.removeItem("msal_token"))};return(0,a.jsx)(c.Provider,{value:{token:o,isAuthenticated:!!o,login:l,logout:r},children:t})},h=()=>{let e=(0,i.useContext)(c);if(!e)throw Error("useAuth must be within AuthProvider");return e}},9324:()=>{},9840:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}}},e=>{var t=t=>e(e.s=t);e.O(0,[385,95,441,684,358],()=>t(2212)),_N_E=e.O()}]);
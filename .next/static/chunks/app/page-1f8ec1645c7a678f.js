(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1698:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(5155),r=a(2115);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:n="",children:u,iconNode:m,...h}=e;return(0,r.createElement)("svg",{ref:t,...d,width:s,height:s,stroke:a,strokeWidth:l?24*Number(i)/Number(s):i,className:o("lucide",n),...!u&&!c(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),m=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:l,...c}=a;return(0,r.createElement)(u,{ref:s,iconNode:t,className:o("lucide-".concat(i(n(e))),"lucide-".concat(e),l),...c})});return a.displayName=n(e),a},h=m("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),p=m("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),x=m("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),f={src:"/_next/static/media/GSHAND_HIRES_WHITE.fd39495e.png"},g=e=>{let{timestamp:t,className:a=""}=e,[i,l]=(0,r.useState)(""),[n,o]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{o(!0),l(t.toLocaleTimeString())},[t]),n)?(0,s.jsx)("span",{className:a,children:i}):(0,s.jsx)("span",{className:a})};var w=a(7291);let y=()=>{let{token:e,isAuthenticated:t,login:a,logout:i}=(0,w.A)(),[l,n]=(0,r.useState)(""),[o,c]=(0,r.useState)([{id:"1",text:"Hello! I'm your Email Assistant. How can I help you today?",isUser:!1,timestamp:new Date}]),[d,u]=(0,r.useState)(!1),m=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;null==(e=m.current)||e.scrollIntoView({behavior:"smooth"})},[o]);let y=async()=>{if(!l.trim())return;let t={id:Date.now().toString(),text:l,isUser:!0,timestamp:new Date};c(e=>[...e,t]),n(""),u(!0);let a="",s="";try{var r,i,o;let t=await fetch("/api/n8n",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:"Bearer ".concat(e)}:{}},body:JSON.stringify({query:l,userCredentials:e?{id:"nFRdh6ECDj2XCXiy",name:"Microsoft Outlook account",token:e}:null})});if(!t.ok)throw Error("HTTP ".concat(t.status," ").concat(t.statusText));s=await t.text();let n=JSON.parse(s);a=Array.isArray(n)&&(null==(o=n[0])||null==(i=o.message)||null==(r=i.content)?void 0:r.message)?n[0].message.content.message:s}catch(e){a="Error: ".concat(e.message),/401|403/.test(e.message)&&(a+=" Please authenticate with Outlook."),console.log("Error details:",e.message,"Raw response:",s)}let d={id:(Date.now()+1).toString(),text:a,isUser:!1,timestamp:new Date};c(e=>[...e,d]),u(!1)};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-[90vw] max-w-4xl mx-auto glass-container fade-in",children:[(0,s.jsx)("div",{className:"p-6 border-b border-white/10 flex justify-center",children:(0,s.jsx)("img",{src:f.src,alt:"GS Logo",className:"w-1/2 h-auto object-contain"})}),(0,s.jsxs)("div",{className:"h-96 overflow-y-auto p-6 space-y-4 custom-scrollbar",children:[o.map(e=>(0,s.jsx)("div",{className:"flex ".concat(e.isUser?"justify-end":"justify-start"," slide-up"),children:(0,s.jsxs)("div",{className:"flex items-start gap-3 max-w-[80%]",children:[!e.isUser&&(0,s.jsx)("div",{className:"p-2 rounded-full bg-white/10 backdrop-blur-sm",children:(0,s.jsx)(h,{className:"w-4 h-4 text-blue-400"})}),(0,s.jsxs)("div",{className:"message-bubble p-4 whitespace-pre-wrap ".concat(Date.now()-e.timestamp.getTime()<5e3?"message-recent":""),children:[e.text,(0,s.jsx)(g,{timestamp:e.timestamp,className:"text-xs text-gray-500 mt-2 self-end"})]}),e.isUser&&(0,s.jsx)("div",{className:"p-2 rounded-full bg-blue-500/20 backdrop-blur-sm",children:(0,s.jsx)(p,{className:"w-4 h-4 text-blue-400"})})]})},e.id)),(0,s.jsx)("div",{ref:m})]}),(0,s.jsxs)("div",{className:"p-6 border-t border-white/10",children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y()},className:"flex items-start gap-4 mb-4",children:[(0,s.jsx)("textarea",{value:l,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},placeholder:"Type your message...",rows:2,disabled:d,className:"glass-input resize-none flex-1 min-h-[56px] max-h-[96px] p-3 focus:outline-none focus:drop-shadow-[0_0_8px_rgba(59,130,246,1)]"}),(0,s.jsxs)("button",{type:"submit",disabled:d||!l.trim()||!t,className:"glass-button send-button px-10 py-5 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(x,{className:"w-4 h-4"}),"Send"]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("button",{onClick:t?i:a,className:"glass-button action-button px-10 py-5",children:t?"Sign Out":"Login with Outlook"})}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-500",children:t?(0,s.jsx)("span",{className:"text-green-400",children:"✓ Authenticated"}):(0,s.jsx)("span",{className:"text-red-400",children:"⚠ Not signed in"})})})]})]})})},v=()=>(0,s.jsx)("div",{className:"fixed-width-container",children:(0,s.jsx)(y,{})})},7291:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>u,A:()=>m});var s=a(5155),r=a(2115),i=a(2095),l=a(8544);a(9509);let n={auth:{clientId:"e6aa6227-d8e8-4fd4-90d0-761af7afb40d",authority:"https://login.microsoftonline.com/common",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{logLevel:l.$.Info}}},o={scopes:["openid","profile","offline_access","Mail.Send","Mail.ReadWrite","Calendars.ReadWrite"]},c=(0,r.createContext)(void 0),d=new i.vq(n),u=e=>{let{children:t}=e,[a,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!d)return;d.initialize().catch(e=>console.warn("MSAL init warning:",e));let e=localStorage.getItem("msal_token");e&&i(e)},[]);let l=async()=>{if(d)try{await d.initialize();let e=await d.loginPopup(o);i(e.accessToken),localStorage.setItem("msal_token",e.accessToken)}catch(e){console.error("Login failed",e)}},n=async()=>{d&&(await d.logoutPopup(),i(null),localStorage.removeItem("msal_token"))};return(0,s.jsx)(c.Provider,{value:{token:a,isAuthenticated:!!a,login:l,logout:n},children:t})},m=()=>{let e=(0,r.useContext)(c);if(!e)throw Error("useAuth must be within AuthProvider");return e}},9093:(e,t,a)=>{Promise.resolve().then(a.bind(a,1698))}},e=>{var t=t=>e(e.s=t);e.O(0,[95,441,684,358],()=>t(9093)),_N_E=e.O()}]);